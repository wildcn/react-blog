{"version":3,"sources":["../static/js/7.ac262133.chunk.js","containers/Block/CommonNewsList/reducer.js"],"names":["webpackJsonp","505","module","__webpack_exports__","__webpack_require__","resetList","list","categoriesPath","categoriesInfo","__WEBPACK_IMPORTED_MODULE_2__modules_datas__","map","item","index","id","console","log","newGategories","categories","name","active","url","format","css","author","fetch","__WEBPACK_IMPORTED_MODULE_3__modules_Apis__","getUserInfo","then","res","json","data","userInfo","categoriesName","i","push","cate","reducer","state","arguments","length","undefined","initialState","action","type","__WEBPACK_IMPORTED_MODULE_1__action__","payload","__WEBPACK_IMPORTED_MODULE_0_immutable__","curPond","pageIndex","toIndex","direction","cur","toJS","imgsLength","media_all","width","__WEBPACK_IMPORTED_MODULE_4__modules_option__","layout","primary","listflow","liWidth","pointindex","setIn","newState","set","concat","Object","defineProperty","value","n","__WEBPACK_IMPORTED_MODULE_5__option__","limit"],"mappings":"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","file":"static/js/7.ac262133.chunk.js","sourcesContent":["webpackJsonp([7],{\n\n/***/ 505:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_immutable__ = __webpack_require__(125);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_immutable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_immutable__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__action__ = __webpack_require__(231);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__modules_datas__ = __webpack_require__(230);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__modules_Apis__ = __webpack_require__(79);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__modules_option__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__option__ = __webpack_require__(128);\nvar showNumber=__WEBPACK_IMPORTED_MODULE_5__option__[\"a\" /* default */].limit;// 默认显示的文章数量\nvar initialState=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_immutable__[\"fromJS\"])({curPond:[],pageIndex:1,categories:[]});// 拿栏目数据\nfunction resetList(list){var result={},categoriesPath={};var categoriesInfo={};__WEBPACK_IMPORTED_MODULE_2__modules_datas__[\"b\" /* Categories */].map(function(item,index){categoriesInfo[item.id]=item;});console.log(categoriesInfo);list.map(function(item,index){var newGategories={id:item.categories[0],name:categoriesInfo[item.categories[0]]&&categoriesInfo[item.categories[0]].name,active:false};item.url='detail/'+item.id;item.categories=newGategories;if(!categoriesPath[newGategories.id]){categoriesPath[newGategories.id]=newGategories;}// 相册增加状态\nif(item.format==='image'){item.css='translate3d(0px,0px,0px)';item.index=0;}if(item.format==='aside'&&item.author){fetch(__WEBPACK_IMPORTED_MODULE_3__modules_Apis__[\"a\" /* default */].getUserInfo+item.author).then(function(res){return res.json();}).then(function(data){item.userInfo=data;});}return item;});// 为栏目增加所有\ncategoriesPath[0]={id:0,name:'所有',active:true};console.log(categoriesPath);var categoriesName=[];for(var i in categoriesPath){categoriesName.push(categoriesPath[i]);}return{cate:categoriesName,data:list};}function reducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments[1];switch(action.type){case __WEBPACK_IMPORTED_MODULE_1__action__[\"CommonNewsListRender\"]+'_SUCCESS':// 新闻列表抓取成功\nvar newsList=action.payload,categoriesPath={};// 将栏目名称放入数据中\nvar list=resetList(action.payload);return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_immutable__[\"fromJS\"])({curPond:list.data,categories:list.cate,pageIndex:1});case __WEBPACK_IMPORTED_MODULE_1__action__[\"CommonNewsListOnClick\"]:console.log('News CommonNewsListOnClick click');return state;case __WEBPACK_IMPORTED_MODULE_1__action__[\"PhotosChange\"]:// 瀑布流相册图片切换\nvar index=--action.payload.index,direction=action.payload.direction||0,cur=state.toJS().curPond[index],imgsLength=cur.media_all.length-1,width=__WEBPACK_IMPORTED_MODULE_4__modules_option__[\"a\" /* default */].layout.primary.listflow.liWidth;var toIndex;// 设定目标图片 两边则循环\nif(direction==='left'){toIndex=cur.index<=0?imgsLength:--cur.index;}else if(direction==='right'){toIndex=cur.index>=imgsLength?0:++cur.index;}else{toIndex=action.payload.pointindex;}cur.css='translate3d(-'+toIndex*width+'px,0px,0px)';cur.index=toIndex;return state.setIn(['curPond',index],__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_immutable__[\"fromJS\"])(cur));// 翻页请求\ncase __WEBPACK_IMPORTED_MODULE_1__action__[\"CommonNewsNext\"]+'_SUCCESS':var list=resetList(action.payload),newState=state.toJS();return state.set('curPond',__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_immutable__[\"fromJS\"])(newState.curPond.concat(list.data))).set('categories',__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_immutable__[\"fromJS\"])(list.cate)).set('pageIndex',newState.pageIndex+1);default:return state;}}/* harmony default export */ __webpack_exports__[\"default\"] = (reducer);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/7.ac262133.chunk.js","import {\n  fromJS\n} from 'immutable'\nimport {\n  CommonNewsListOnClick,\n  CommonNewsListRender,\n  PhotosChange,\n  CommonNewsNext\n} from './action'\nimport {\n  Categories,\n} from './../../../modules/datas'\nimport Apis from '../../../modules/Apis'\nimport options from './../../../modules/option'\nimport variable from './option';\nconst showNumber = variable.limit; // 默认显示的文章数量\nconst initialState = fromJS({\n  curPond: [],\n  pageIndex: 1,\n  categories: [],\n});\n\n// 拿栏目数据\nfunction resetList(list) {\n  var result = {},\n    categoriesPath = {};\n  var categoriesInfo = {};\n  Categories.map((item, index) => {\n    categoriesInfo[item.id] = item;\n  });\n  console.log(categoriesInfo)\n  list.map((item, index) => {\n\n    var newGategories = {\n      id: item.categories[0],\n      name: categoriesInfo[item.categories[0]] && categoriesInfo[item.categories[0]].name,\n      active: false\n    }\n    item.url = `detail/${item.id}`;\n    item.categories = newGategories;\n    if (!categoriesPath[newGategories.id]) {\n      categoriesPath[newGategories.id] = newGategories;\n    }\n    // 相册增加状态\n    if (item.format === 'image') {\n      item.css = 'translate3d(0px,0px,0px)';\n      item.index = 0;\n    }\n    if (item.format === 'aside' && item.author) {\n      fetch(Apis.getUserInfo + item.author).then(res => res.json()).then(data => {\n        item.userInfo = data;\n      })\n    }\n    return item;\n  });\n  // 为栏目增加所有\n  categoriesPath[0] = {\n    id: 0,\n    name: '所有',\n    active: true,\n  }\n  console.log(categoriesPath)\n  var categoriesName = [];\n  for (var i in categoriesPath) {\n    categoriesName.push(categoriesPath[i]);\n  }\n  return {\n    cate: categoriesName,\n    data: list\n  }\n}\n\nfunction reducer(state = initialState, action) {\n  switch (action.type) {\n    case CommonNewsListRender + '_SUCCESS':\n      // 新闻列表抓取成功\n      const newsList = action.payload,\n        categoriesPath = {}\n        // 将栏目名称放入数据中\n      var list = resetList(action.payload)\n      return fromJS({\n        curPond: list.data,\n        categories: list.cate,\n        pageIndex: 1\n      })\n    case CommonNewsListOnClick:\n      console.log(`News CommonNewsListOnClick click`)\n      return state;\n    case PhotosChange:\n      // 瀑布流相册图片切换\n      var index = --action.payload.index,\n        direction = action.payload.direction || 0,\n        cur = state.toJS().curPond[index],\n        imgsLength = cur.media_all.length - 1,\n        width = options.layout.primary.listflow.liWidth;\n      var toIndex;\n      // 设定目标图片 两边则循环\n      if (direction === 'left') {\n        toIndex = cur.index <= 0 ? imgsLength : --cur.index;\n      } else if (direction === 'right') {\n        toIndex = cur.index >= imgsLength ? 0 : ++cur.index;\n      } else {\n        toIndex = action.payload.pointindex;\n      }\n      cur.css = `translate3d(-${toIndex*width}px,0px,0px)`;\n      cur.index = toIndex;\n      return state.setIn(['curPond', index], fromJS(cur));\n      // 翻页请求\n    case CommonNewsNext + '_SUCCESS':\n      var list = resetList(action.payload),\n        newState = state.toJS();\n\n      return state\n        .set('curPond', fromJS(newState.curPond.concat(list.data)))\n        .set('categories', fromJS(list.cate))\n        .set('pageIndex', newState.pageIndex + 1)\n    default:\n      return state;\n  }\n}\nexport default reducer;\n\n\n// WEBPACK FOOTER //\n// ./src/containers/Block/CommonNewsList/reducer.js"],"sourceRoot":""}